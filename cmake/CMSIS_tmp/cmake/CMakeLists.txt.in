cmake_minimum_required(VERSION 3.13)
project(@PROJECT_NAME@
    VERSION @PROJECT_VERSION@)

set(STM32_CHIP "@STM32_CHIP@")
set(STM32_FAMILY @STM32_FAMILY@)
set(STM32_TYPE @STM32_TYPE@)
set(STM32_SIZE_CODE @STM32_SIZE_CODE@)
set(STM32_ARM_CORE @STM32_ARM_CORE@)

add_library(${PROJECT_NAME} INTERFACE)
list(TRANSFORM CMSIS_COMMON_HEADERS PREPEND "${CMAKE_CURRENT_LIST_DIR}/include/" OUTPUT_VARIABLE CMSIS_COMMON_HEADERS_I)
list(TRANSFORM CMSIS_DEVICE_HEADERS PREPEND "${CMAKE_CURRENT_LIST_DIR}/include/" OUTPUT_VARIABLE CMSIS_DEVICE_HEADERS_I)
target_sources(${PROJECT_NAME}
    INTERFACE
        # Sources
        ${CMAKE_CURRENT_LIST_DIR}/src/system_stm32@STM32_FAMILY_LOW@xx.c
       # ${CMAKE_CURRENT_LIST_DIR}/src/startup_@STM32_STARTUP@.s
        # Header
        ${CMSIS_COMMON_HEADERS_I}
        ${CMSIS_DEVICE_HEADERS_I}
)
target_include_directories(${PROJECT_NAME}
    INTERFACE
        ${CMAKE_CURRENT_LIST_DIR}/include
)
get_target_property(COMPILE_DEFINITIONS ${TARGET_NAME} COMPILE_DEFINITIONS)
target_compile_definitions(${PROJECT_NAME}
    INTERFACE
    ${COMPILE_DEFINITIONS}
    ${STM32_COMPILE_DEFINITIONS}
)